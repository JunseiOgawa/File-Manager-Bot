# 要件定義書: DiscordMeaageFilePublic

## 1. 概要
管理者や指定された権限を持つユーザーが、指定されたDiscordチャンネルに投稿したファイル（`.jar`など）を自動的に収集し、**gofile.io** にアップロードして、ダウンロードURLを生成・共有するBotシステム。

## 2. ターゲットユーザー
- サーバー管理者
- 指定された権限を持つユーザー

## 3. 機能要件

### 3.1 ファイル監視と収集
- **対象チャンネル**: 指定された特定のチャンネル（監視用）を監視。
- **対象ファイル**: `.jar` などの指定された拡張子を持つファイル。

### 3.2 キャンセル機能（除外処理）
- **仕組み**: Discordの「返信（Reply）」機能を使用。
- **動作**: 待機中に「キャンセル」等の返信が行われた場合、除外する。

### 3.3 アップロードの実行トリガー（自動遅延実行）
- **仕様**: 最後の有効なファイル投稿から **1分後** に処理を開始する。
- **割り込み・リセット処理**:
    - 待機中（1分間）に「新規ファイルの投稿」または「キャンセル返信」があった場合、**カウントダウンをリセット**し、その時点から再度1分待機する。

### 3.4 ファイルアップロード処理（gofile.io）
- **アップロード先**: gofile.io (匿名/一時アップロード)
- **処理フロー**:
    1. 1分間の待機完了後、対象ファイルをBotが一時取得。
    2. gofile.io のAPIを使用してアップロード。
    3. ダウンロードURLを取得。
- **制約事項**:
    - **レートリミット**: gofile.io のAPIガイドラインに従う（基本的には過度な連打を避ける）。
    - 30MB以上のファイルにも対応。

### 3.5 結果通知
- **通知先**: 指定された完了通知用チャンネル。
- **内容**: 
    - 「以下の配布ファイルを更新しました」というメッセージ。
    - gofile.io のダウンロードURLリスト。

## 4. 必要な権限と設定
### 4.1 Discord Bot 権限
- **Message Content Intent**: 必須。
- **Send Messages**: 必須。
- **Read Message History**: 必須。


## 5. 非機能要件
- **レスポンス制御**: 外部サービス（GigaFile）へのアクセス頻度を厳守する。
- **拡張性**: 設定ファイルで定数（待機時間1分など）を変更可能にする。
